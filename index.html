<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MCCNETWORLD</title>

<!-- ✅ 여기부터 OG 메타태그 추가 -->
<meta property="og:title" content="MCCNETWORLD" />
<meta property="og:description" content="여기 글을 눌러 링크를 확인하세요." />
<meta property="og:url" content="https://mcc-cmd.github.io/mccnetworld/index.html" />
<meta property="og:image" content="https://mcc-cmd.github.io/mccnetworld/assets/og-mcc.png" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="MCCNETWORLD" />
<!-- ✅ 여기까지 OG 메타태그 추가 -->

<link rel="icon" href="./favicon.ico?v=2">
<link rel="icon" type="image/png" sizes="16x16"  href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32"  href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="shortcut icon" href="favicon.ico">

<style>
/* =========================================================
  [1] 기본 테마/레이아웃
========================================================= */
:root{
  --bg:#f6f8fb;
  --card:#ffffff;
  --line:#e5e9f2;
  --fg:#0b1220;
}
*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--fg);
  font:15px/1.6 system-ui,"Noto Sans KR",sans-serif;
}
.wrap{max-width:1200px;margin:0 auto;padding:18px}
.panel{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(16,24,40,.04);
}

/* =========================================================
  [2] 상단 헤더
========================================================= */
.hd{
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:14px 16px;
  border-bottom:1px solid var(--line);
}
.hd strong{font-weight:900;letter-spacing:.2px}
.hd-actions{
  position:absolute;
  right:14px;
  top:50%;
  transform:translateY(-50%);
  display:flex;
  gap:8px;
}
.hd-btn{
  padding:8px 12px;
  border-radius:10px;
  border:1px solid var(--line);
  background:#fff;
  cursor:pointer;
  font-weight:800;
  font-size:12px;
}
.hd-btn:hover{box-shadow:0 6px 18px rgba(2,6,23,.08)}

/* =========================================================
  [3] 섹션/탭/그리드
========================================================= */
.stack{padding:20px}
.section-title{font-weight:900;margin:0 0 12px 2px;font-size:16px}
.tabs{display:flex;gap:8px;margin-bottom:12px}
.tab-btn{
  padding:8px 16px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff;
  cursor:pointer
}
.tab-btn.active{
  background:#111827;
  color:#fff;
  border-color:#111827
}
.brand-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:18px;
  margin:6px 0 20px;
}

/* =========================================================
  [3-1] 가입서류: 통신사별 섹션
========================================================= */
.group-wrap{
  display:flex;
  flex-direction:column;
  gap:16px;
  margin:6px 0 20px;
}
.group{
  border:1px solid var(--line);
  background:#fff;
  border-radius:18px;
  padding:14px 14px 16px;
  box-shadow:0 10px 30px rgba(16,24,40,.03);
}
.group-head{
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:12px;
}
.group-dot{
  width:10px;height:10px;border-radius:999px;
  background:var(--g-accent);
  box-shadow:0 0 0 4px rgba(0,0,0,.03);
}
.group-title{font-weight:900;letter-spacing:-0.2px}
.group-sub{
  margin-left:auto;
  font-size:12px;
  color:#64748b;
}
.group[data-carrier="sk"]{ --g-accent:#2563eb; }
.group[data-carrier="kt"]{ --g-accent:#0ea5e9; }
.group[data-carrier="uplus"]{ --g-accent:#8b5cf6; }
.group[data-carrier="device"]{ --g-accent:#111827; }
.group[data-carrier="prepaid"]{ --g-accent:#f59e0b; } /* 선불 섹션 포인트 색 */


/* =========================================================
  [4] 카드(브랜드)
========================================================= */
.brand{
  position:relative;
  border-radius:18px;
  cursor:pointer;
  transition:transform .08s ease, box-shadow .15s ease, border-color .15s ease;
  border:1px solid var(--line);
  background:linear-gradient(180deg,#fff,#fafcff);
  overflow:hidden;
}
.brand:hover{transform:translateY(-1px);box-shadow:0 8px 24px rgba(2,6,23,.08)}
.logo-frame{
  width:180px;
  height:60px;
  margin:18px auto 10px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:transparent;
  border:0;
  border-radius:0;
  box-shadow:none;
  padding:0;
}
.logo-frame img{
  max-width:100%;
  max-height:100%;
  object-fit:contain;
  display:block;
}
.brand.long-name .name{font-size:15px;font-weight:800}
.cap{
  text-align:center;
  padding:0 18px 18px;
  color:#475467;
  font-size:12px;
}

/* =========================================================
  [5] 테마
========================================================= */
.theme-um{--chip-bg:#f3e8ff;--chip-fg:#3b0764;--chip-bd:#8b5cf6}
.theme-mm{--chip-bg:#e0f2fe;--chip-fg:#0b4a6f;--chip-bd:#38bdf8}
.theme-s7{--chip-bg:#d1fae5;--chip-fg:#064e3b;--chip-bd:#10b981}
.theme-pr{--chip-bg:#dbeafe;--chip-fg:#1e40af;--chip-bd:#60a5fa}

/* =========================
   구비서류 모달(확대 지원)
========================= */
.modal{
  position:fixed;
  inset:0;
  display:none;
  z-index:9999;
}
.modal[aria-hidden="false"]{ display:block; }
.modal-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
.modal-panel{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(1200px, 96vw);
  height:min(760px, 92vh);
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.25);
  display:flex;
  flex-direction:column;
}
.modal-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 14px;
  border-bottom:1px solid var(--line);
}
.modal-body{
  flex:1;
  overflow:auto;
  background:#0b1220;
  padding:12px;
}
#docsImg{
  width:100%;
  height:auto;
  display:block;
  transform-origin: top left;
  cursor: zoom-in;
}
#docsImg.zoom{
  transform: scale(2.5);
  cursor: zoom-out;
}
.brand .name{ display:none; }

/* 워터마크 */
.group{
  position: relative;
  overflow: hidden;
}
.group::after{
  content:"";
  position:absolute;
  inset:0;
  background-image:url("./assets/brand/mcc-watermark.png");
  background-repeat:no-repeat;
  background-position:right 18px bottom 14px;
  background-size:180px auto;
  opacity:0.10;
  pointer-events:none;
  z-index:0;
}
.group > *{position:relative;z-index:1}

/* =========================================================
  [NEW] 단말개통 "업데이트 예정" 모달
========================================================= */
.cs-modal{
  position:fixed;
  inset:0;
  display:none;
  z-index:10000;
}
.cs-modal[aria-hidden="false"]{display:block}
.cs-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
.cs-panel{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(420px, calc(100% - 32px));
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.25);
}
.cs-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 14px;
  border-bottom:1px solid var(--line);
}
.cs-head strong{font-weight:900}
.cs-x{
  border:1px solid var(--line);
  background:#fff;
  border-radius:10px;
  padding:6px 10px;
  cursor:pointer;
  font-weight:800;
  font-size:12px;
}
.cs-body{
  padding:14px;
  color:#111;
  font-weight:800;
  font-size:13px;
  line-height:1.6;
}
.cs-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  padding:0 14px 14px;
}
.cs-btn{
  border:none;
  border-radius:10px;
  padding:8px 14px;
  background:#111827;
  color:#fff;
  font-weight:900;
  cursor:pointer;
}

/* =========================================================
  ✅ [NEW] 동판 옆 빈칸에 "유심양식/동판양식" 2개 반반(절반) 배치
========================================================= */
.form-duo-wrap{
  border:1px solid var(--line);
  background:linear-gradient(180deg,#fff,#fafcff);
  border-radius:18px;
  overflow:hidden;
  padding:14px;
  cursor:default;
  transition:transform .08s ease, box-shadow .15s ease, border-color .15s ease;
}
.form-duo-wrap:hover{
  transform:translateY(-1px);
  box-shadow:0 8px 24px rgba(2,6,23,.08);
}
.form-duo{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
.form-duo .form-half{
  border:1px solid var(--line);
  background:#fff;
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  min-height:84px;
  cursor:pointer;
  transition:transform .08s ease, box-shadow .15s ease, border-color .15s ease;
}
.form-duo .form-half:hover{
  transform:translateY(-1px);
  box-shadow:0 8px 24px rgba(2,6,23,.08);
}
.form-duo .form-text{
  font-weight:900;
  font-size:24px;
  letter-spacing:-0.2px;
  color:#0b1220;
}
@media (max-width:720px){
  .form-duo{grid-template-columns:1fr;}
  .form-duo .form-text{font-size:22px}
}

/* =========================================================
  ✅ [NEW] 양식 팝업(복사 버튼 포함)
========================================================= */
.form-modal{
  position:fixed;
  inset:0;
  display:none;
  z-index:11000;
}
.form-modal[aria-hidden="false"]{display:block}
.form-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.55)}
.form-panel{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(760px, calc(100% - 32px));
  background:#fff;
  border-radius:14px;
  overflow:hidden;
  box-shadow:0 20px 60px rgba(0,0,0,.25);
}
.form-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 14px;
  border-bottom:1px solid var(--line);
}
.form-head strong{font-weight:900}
.form-x{
  border:1px solid var(--line);
  background:#fff;
  border-radius:10px;
  padding:6px 10px;
  cursor:pointer;
  font-weight:800;
  font-size:12px;
}
.form-body{padding:14px;}
.form-textarea{
  width:100%;
  height:420px;
  resize:none;
  border:1px solid var(--line);
  border-radius:12px;
  padding:12px;
  font:13px/1.6 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Noto Sans KR", monospace;
  white-space:pre;
  outline:none;
}
.form-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
  padding:0 14px 14px;
}
.form-btn{
  border:none;
  border-radius:10px;
  padding:8px 14px;
  background:#111827;
  color:#fff;
  font-weight:900;
  cursor:pointer;
}
.form-btn.ghost{
  background:#fff;
  color:#111827;
  border:1px solid var(--line);
}
.form-toast{
  margin-top:8px;
  font-size:12px;
  font-weight:800;
  color:#16a34a;
  display:none;
}
.form-toast.show{display:block}
</style>
</head>

<body>
<div class="wrap">
  <section class="panel">

    <div class="hd">
      <strong>MCCNETWORLD</strong>

      <div class="hd-actions">
        <button class="hd-btn" type="button" data-docs="sk">SK 구비서류</button>
        <button class="hd-btn" type="button" data-docs="kt">KT 구비서류</button>
        <button class="hd-btn" type="button" data-docs="lg">LG 구비서류</button>
      </div>
    </div>

    <div class="stack">

      <div class="section-title">가입 서류</div>
      <div id="joinTabs">
        <div class="tabs">
          <button class="tab-btn active" data-target="adult">성인</button>
          <button class="tab-btn" data-target="teen">청소년</button>
        </div>
        <div class="group-wrap" id="joinTabsList"></div>
      </div>
<div class="section-title" style="margin-top:16px">선불 서류</div>
<div id="prepaidSection">
  <div class="group-wrap" id="prepaidList"></div>
</div>

      <div class="section-title" style="margin-top:8px">변경 서류</div>
      <div id="changeTabs">
        <div class="tabs">
          <button class="tab-btn active" data-target="uplus">LG U+</button>
          <button class="tab-btn" data-target="kt">KT</button>
          <button class="tab-btn" data-target="sk">SKT</button>
        </div>
        <div class="brand-grid" id="changeTabsList"></div>
      </div>

      <div class="section-title" style="margin-top:16px">해지 서류</div>
      <div id="cancelTabs">
        <div class="tabs">
          <button class="tab-btn active" data-target="uplus">LG U+</button>
          <button class="tab-btn" data-target="kt">KT</button>
          <button class="tab-btn" data-target="sk">SKT</button>
        </div>
        <div class="brand-grid" id="cancelTabsList"></div>
      </div>

    </div>
  </section>

  <!-- 구비서류 모달 -->
  <div class="modal" id="docsModal" aria-hidden="true">
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-panel" role="dialog" aria-modal="true" aria-label="구비서류 안내">
      <div class="modal-head">
        <strong id="docsTitle">구비서류</strong>
        <button class="modal-x" id="btnDocsClose" type="button">닫기</button>
      </div>
      <div class="modal-body">
        <img id="docsImg" src="" alt="구비서류 이미지" />
      </div>
    </div>
  </div>

  <!-- 업데이트 예정 모달 -->
  <div class="cs-modal" id="comingSoonModal" aria-hidden="true">
    <div class="cs-backdrop" data-cs-close="1"></div>
    <div class="cs-panel" role="dialog" aria-modal="true" aria-label="업데이트 예정 안내">
      <div class="cs-head">
        <strong>업데이트 예정</strong>
        <button class="cs-x" id="csCloseX" type="button">닫기</button>
      </div>
      <div class="cs-body" id="csBody">준비 중인 기능입니다.</div>
      <div class="cs-actions">
        <button class="cs-btn" id="csOkBtn" type="button">확인</button>
      </div>
    </div>
  </div>

  <!-- ✅ [NEW] 유심/동판 양식 팝업 -->
  <div class="form-modal" id="formModal" aria-hidden="true">
    <div class="form-backdrop" data-form-close="1"></div>
    <div class="form-panel" role="dialog" aria-modal="true" aria-label="양식 복사 팝업">
      <div class="form-head">
        <strong id="formTitle">양식</strong>
        <button class="form-x" id="formCloseX" type="button">닫기</button>
      </div>
      <div class="form-body">
        <textarea class="form-textarea" id="formTextarea" readonly></textarea>
        <div class="form-toast" id="formToast">복사되었습니다.</div>
      </div>
      <div class="form-actions">
        <button class="form-btn ghost" id="formSelectAll" type="button">전체선택</button>
        <button class="form-btn" id="formCopyBtn" type="button">복사</button>
      </div>
    </div>
  </div>

</div>

<script>
let JOIN_AGE = 'adult';
function updateDeviceLogosByAge(){
  const age = (JOIN_AGE || 'adult').toLowerCase();

  const me = document.getElementById('deviceLogoME');
  const mo = document.getElementById('deviceLogoMO');

  if (me) me.src = (age === 'teen') ? './assets/logos/METEEN.png' : './assets/logos/ME.png';
  if (mo) mo.src = (age === 'teen') ? './assets/logos/MOTEEN.png' : './assets/logos/MO.png';
}

/* ✅ 미운영(클릭 시 팝업만 띄우고 이동 차단) 브랜드 목록 */
const UNAVAILABLE_BRANDS = new Set([
  '스카이라이프'
]);

const BRANDS = [
  { carrier:'uplus', theme:'theme-um', name:'미디어로그', cap:'',
    logoAdult:'./assets/logos/ME.png', logoTeen :'./assets/logos/METEEN.png' },
  { carrier:'uplus', theme:'theme-um', name:'헬로LG', cap:'',
    logoAdult:'./assets/logos/HELLO.png', logoTeen :'./assets/logos/HELLO TEEN.png' },
  { carrier:'uplus', theme:'theme-pr', name:'프리티LG', cap:'',
    logoAdult:'./assets/logos/FREE LG.png', logoTeen :'./assets/logos/FREE LG TEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'엠모바일', cap:'',
    logoAdult:'./assets/logos/MO.png', logoTeen :'./assets/logos/MOTEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'스테이지파이브(KT)', cap:'',
    logoAdult:'./assets/logos/STAGE KT.png', logoTeen :'./assets/logos/STAGE KT TEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'스카이라이프', cap:'',
    logoAdult:'./assets/logos/SKY.png', logoTeen :'./assets/logos/SKYTEEN.png' },
  { carrier:'sk', theme:'theme-s7', name:'SK텔링크', cap:'',
    logoAdult:'./assets/logos/7M.png', logoTeen :'./assets/logos/7M TEEN.png' },
  { carrier:'sk', theme:'theme-mm', name:'스테이지파이브(SK)', cap:'',
    logoAdult:'./assets/logos/STAGE SK.png', logoTeen :'./assets/logos/STAGE SK TEEN.png' },
  { carrier:'sk', theme:'theme-pr', name:'프리티SK', cap:'',
    logoAdult:'./assets/logos/FREE SK.png', logoTeen :'./assets/logos/FREE SK TEEN.png' }
];
const PREPAID_BRANDS = [
  { theme:'theme-um', name:'스마텔LG',  cap:'', logoAdult:'./assets/logos/PREPAID_SMATEL.png',  brandKey:'smatel_lg' },
  { theme:'theme-pr', name:'LG프리티',  cap:'', logoAdult:'./assets/logos/PREPAID_LGFREET.png', brandKey:'lgfreeT' },
  { theme:'theme-mm', name:'밸류컴',    cap:'', logoAdult:'./assets/logos/PREPAID_VALUE.png',   brandKey:'valuecom' },
  { theme:'theme-pr', name:'SK프리티',  cap:'', logoAdult:'./assets/logos/PREPAID_SKFREET.png', brandKey:'skfreeT' },
  { theme:'theme-mm', name:'코드모바일', cap:'', logoAdult:'./assets/logos/PREPAID_CODE.png',    brandKey:'codemobile' },
].map(b => ({
  ...b,
  carrier:'prepaid',
  doc:'prepaid'
}));


const JOIN_ONLY = [
  { carrier:'kt', theme:'theme-mm', name:'정규KT신규', cap:'', special:true,
    logoAdult:'./assets/logos/KT010.png', logoTeen:'./assets/logos/KT010TEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'정규KT번이', cap:'', special:true,
    logoAdult:'./assets/logos/KTMNP.png', logoTeen:'./assets/logos/KTMNPTEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'KT 유선 동판', cap:'', special:true,
    logoAdult:'./assets/logos/KTINTERNET.png', logoTeen:'./assets/logos/KTINTERNET.png' },
  { carrier:'kt', theme:'theme-mm', name:'웰컴 요금제 신규', cap:'', special:true,
    logoAdult:'./assets/logos/WELCOME010.png', logoTeen:'./assets/logos/WELCOME010TEEN.png' },
  { carrier:'kt', theme:'theme-mm', name:'웰컴 요금제 번이', cap:'', special:true,
    logoAdult:'./assets/logos/WELCOMEMNP.png', logoTeen:'./assets/logos/WELCOMEMNPTEEN.png' }
];

const JOIN_DATA = {
  adult: [
    ...BRANDS.map(b => ({...b, doc:'join', age:'adult'})),
    ...JOIN_ONLY.map(b => ({...b, doc:'join', age:'adult'})),
  ],
  teen : [
    ...BRANDS.map(b => ({...b, doc:'join', age:'teen'})),
    ...JOIN_ONLY.map(b => ({...b, doc:'join', age:'teen'})),
  ]
};

const CHANGE_CARDS = BRANDS.map(b => ({...b, doc:'change'}));
const CANCEL_CARDS = BRANDS.map(b => ({...b, doc:'cancel'}));

const BRAND_ROUTE = {
  '미디어로그':     { carrier:'uplus', brand:'umobile'   },
  '프리티LG':       { carrier:'uplus', brand:'freeT'     },
  '헬로LG':         { carrier:'uplus', brand:'hello'     },
  '엠모바일':       { carrier:'kt',    brand:'mmobile'   },
  '스카이라이프':   { carrier:'kt',    brand:'skylife'   },
  '스테이지파이브(KT)': { carrier:'kt', brand:'stagefive'   },
  '스테이지파이브(SK)':{ carrier:'sk', brand:'stagefive-sk'},
  '프리티SK':       { carrier:'sk',    brand:'freeT-sk'  },

  '정규KT신규':     { external: 'https://online.kt.com/itg/online/index.do?prdcId=709A7E09-98C1-44D7-9FEF-3FF6B87A0F6C' },
  '정규KT번이':     { external: 'https://online.kt.com/itg/online/index.do?prdcId=A8C59E15-A80C-4457-BE40-613A13A86A4F' },
  '웰컴 요금제 신규': { external: 'https://online.kt.com/itg/online/index.do?prdcId=3CD28EA5-9336-4B9C-830F-0C3C99098F59' },
  '웰컴 요금제 번이': { external: 'https://online.kt.com/itg/online/index.do?prdcId=DC0AECBA-F1F2-4593-9F0C-4EBC96D139FF' },
  'KT 유선 동판':  { external: 'https://online.kt.com/itg/simple/simpleCustomerInfoPop.do?prdcId=3E9818A3-37F5-4FA0-B575-C624AF106F89' },

  'SK텔링크': {
    carrier: 'sk',
    brand: '7mobile',
    externalJoin: 'https://smvno.sk7mobile.com/main.do'
  }
};

function buildBrandUrl(route, doc, age){
  if (!route || !route.carrier || !route.brand) return '#';

  const base = `brands/${route.carrier}/${route.brand}/index.html`;
  const abs  = new URL(base, location.href).href;

  const qs = new URLSearchParams();
  qs.set('mode','fill');
  qs.set('doc', doc || 'join');
  if ((doc || 'join') === 'join') qs.set('age', age || 'adult');

  return `${abs}?${qs.toString()}`;
}

function pickLogo(item){
  if (item.doc === 'join'){
    if (item.age === 'teen') return item.logoTeen || item.logoAdult || '';
    return item.logoAdult || item.logoTeen || '';
  }
  return item.logoAdult || item.logoTeen || '';
}

function card(item){
  const {theme, name, cap, doc, age} = item;
  const dataName = name.replace(/\(청소년\)/,'');
  const docAttr  = doc || 'join';
  const ageAttr  = (docAttr==='join' && age) ? ` data-age="${age}"` : '';
  const keyAttr = item.brandKey ? ` data-brandkey="${item.brandKey}"` : '';
  const isLong  = name.length >= 9;
  const longCls = isLong ? 'long-name' : '';

  const logo = pickLogo(item);
  const logoHtml = logo
    ? `<div class="logo-frame"><img src="${logo}" alt="${name} 로고"></div>`
    : '';

  return `
    <div class="brand ${theme} ${longCls}" data-name="${dataName}" data-doc="${docAttr}"${ageAttr}${keyAttr}>
      ${logoHtml}
      <div class="name">${name}</div>
      ${cap ? `<div class="cap">${cap}</div>` : ``}
    </div>
  `;
}

/* ✅ "유심양식/동판양식" 2개를 한 칸 안에 절반씩 */
function formDuoCard(){
  return `
    <div class="form-duo-wrap" aria-label="동판 양식 묶음">
      <div class="form-duo">
        <div class="form-half" data-form="usim" role="button" tabindex="0" aria-label="유심양식 열기">
          <div class="form-text">유심양식</div>
        </div>
        <div class="form-half" data-form="dongpan" role="button" tabindex="0" aria-label="동판양식 열기">
          <div class="form-text">동판양식</div>
        </div>
      </div>
    </div>
  `;
}

/* ✅ [핵심 수정]
   단말 개통은 "업데이트 예정" 카드로만 표시(이동/링크 없음)
   + 성인/청소년에 따라 로고만 바뀌게 id 유지
*/
function deviceSectionHTML(){
  return `
    <section class="group" data-carrier="device">
      <div class="group-head">
        <span class="group-dot"></span>
        <span class="group-title">단말 개통</span>
        <span class="group-sub">업데이트 예정</span>
      </div>
      <div class="brand-grid">
        <div class="brand theme-um device-comingsoon" data-device="미디어로그">
          <div class="logo-frame">
            <img id="deviceLogoME" src="./assets/logos/ME.png" alt="미디어로그 로고">
          </div>
          <div class="cap">업데이트 예정</div>
        </div>

        <div class="brand theme-mm device-comingsoon" data-device="엠모바일">
          <div class="logo-frame">
            <img id="deviceLogoMO" src="./assets/logos/MO.png" alt="엠모바일 로고">
          </div>
          <div class="cap">업데이트 예정</div>
        </div>
      </div>
    </section>
  `;
}

/* 카드 클릭 시 이동 */
function attachNavigateHandlers(scope){
  scope.querySelectorAll('.brand').forEach(cardEl=>{
    cardEl.addEventListener('click', (e)=>{
      e.preventDefault();
      e.stopPropagation();

      /* ✅ (남아있을 수 있는) device-link가 있으면 이동 */
      if (cardEl.classList.contains('device-link')) {
        const url = cardEl.getAttribute('data-url') || '';
        if (url) location.href = url;
        return;
      }

      /* ✅ 업데이트 예정(단말) */
      if (cardEl.classList.contains('device-comingsoon')) return;

      const nm = (cardEl.getAttribute('data-name') || '')
        .replace(/\s+/g, ' ')
        .trim();

      const doc = cardEl.getAttribute('data-doc') || 'join';
      const age = cardEl.getAttribute('data-age') || '';

      if (UNAVAILABLE_BRANDS.has(nm)) {
        alert('미운영 회사입니다. (현재 서류 제공/접수 불가)');
        return;
      }
// ✅ 선불 서류: 전용 뷰어 페이지로 이동(팝업/모달 없이 운영 통일)
if (doc === 'prepaid') {
  const key = cardEl.getAttribute('data-brandkey') || '';
  if (key) {
    location.href = `./brands/prepaid/index.html?brand=${encodeURIComponent(key)}`;
  }
  return;
}

      const route = BRAND_ROUTE[nm];
      if (!route) {
        console.warn('[route] 매핑 없음:', nm);
        return;
      }

      if (route.externalJoin && doc === 'join') {
        location.href = route.externalJoin;
        return;
      }

      if (route.external) {
        location.href = route.external;
        return;
      }

      const url = buildBrandUrl(route, doc, age);
      if (url !== '#') location.href = url;
    });
  });
}

function safeRender(listEl, items){
  try{
    listEl.innerHTML = (items && items.length)
      ? items.map(card).join('')
      : '<div style="opacity:.6">자료 없음</div>';

    attachNavigateHandlers(listEl);
  }catch(err){
    console.error('[render error]', err);
    listEl.innerHTML = '<div style="color:#b91c1c;font-weight:800">렌더 오류 – 콘솔을 확인하세요.</div>';
  }
}
function prepaidSectionHTML(items){
  return `
    <section class="group" data-carrier="prepaid">
      <div class="group-head">
        <span class="group-dot"></span>
        <span class="group-title">선불 서류</span>
        <span class="group-sub"></span>
      </div>
      <div class="brand-grid">
        ${items.map(card).join('')}
      </div>
    </section>
  `;
}

function renderPrepaid(listEl){
  listEl.innerHTML = prepaidSectionHTML(PREPAID_BRANDS);
  attachNavigateHandlers(listEl);
}

function prepaidSectionHTML(items){
  return `
    <section class="group" data-carrier="prepaid">
      <div class="group-head">
        <span class="group-dot"></span>
        <span class="group-title">선불 서류</span>
        <span class="group-sub"></span>
      </div>
      <div class="brand-grid">
        ${items.map(card).join('')}
      </div>
   </section>
  `;
}

function renderPrepaid(listEl){
  listEl.innerHTML = prepaidSectionHTML(PREPAID_BRANDS);
  attachNavigateHandlers(listEl);
}


function renderJoinGrouped(listEl, items){
  const specialItems = items.filter(x => x.special === true);
  const normalItems  = items.filter(x => !x.special);

  const groups = [
    { key:'uplus', title:'LG', sub:'' },
    { key:'kt',    title:'KT', sub:'' },
    { key:'sk',    title:'SK', sub:'' },
  ];

  const by = {
    uplus: normalItems.filter(x => x.carrier === 'uplus'),
    kt:    normalItems.filter(x => x.carrier === 'kt'),
    sk:    normalItems.filter(x => x.carrier === 'sk'),
  };

  const normalHTML = groups.map(g => {
    const arr = by[g.key] || [];
    if (!arr.length) return '';
    return `
      <section class="group" data-carrier="${g.key}">
        <div class="group-head">
          <span class="group-dot"></span>
          <span class="group-title">${g.title}</span>
          <span class="group-sub">${g.sub}</span>
        </div>
        <div class="brand-grid">
          ${arr.map(card).join('')}
        </div>
      </section>
    `;
  }).join('');

  /* ✅ KT 링크(정규/웰컴/동판) + 유심/동판 양식 */
  const specialHTML = specialItems.length ? `
    <section class="group" data-carrier="kt">
      <div class="group-head">
        <span class="group-dot"></span>
        <span class="group-title">KT 링크</span>
        <span class="group-sub"></span>
      </div>
      <div class="brand-grid">
        ${specialItems.map(card).join('')}
        ${formDuoCard()}
      </div>
    </section>
  ` : '';

  /* ✅ [핵심 수정]
     단말개통은 "가입서류 영역 제일 하단"으로 배치 */
  listEl.innerHTML = normalHTML + specialHTML + deviceSectionHTML();

  attachNavigateHandlers(listEl);
}

function wireKindTabs(containerId, listId, dataObj){
  const container = document.getElementById(containerId);
  const list = document.getElementById(listId);

  container.querySelectorAll('.tab-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      container.querySelectorAll('.tab-btn').forEach(x=>x.classList.remove('active'));
      btn.classList.add('active');

      JOIN_AGE = btn.dataset.target;
      renderJoinGrouped(list, (dataObj||{})[JOIN_AGE] || []);
      updateDeviceLogosByAge();
    });
  });

  container.querySelector('.tab-btn.active').click();
}

function wireTabs(containerId, listId, data){
  const container = document.getElementById(containerId);
  const list = document.getElementById(listId);

  container.querySelectorAll('.tab-btn').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      container.querySelectorAll('.tab-btn').forEach(x=>x.classList.remove('active'));
      btn.classList.add('active');

      const target = btn.dataset.target;
      const items = (data||[]).filter(d=>d.carrier===target);
      safeRender(list, items);
    });
  });

  container.querySelector('.tab-btn.active').click();
}

/* 구비서류 모달 */
(function(){
  const modal = document.getElementById('docsModal');
  const imgEl = document.getElementById('docsImg');
  const titleEl = document.getElementById('docsTitle');
  const closeBtn = document.getElementById('btnDocsClose');

  imgEl.addEventListener('click', ()=> imgEl.classList.toggle('zoom'));

  const DOCS = {
    sk: { title:'SK 구비서류', src:'./assets/docs/required_sk.png' },
    kt: { title:'KT 구비서류', src:'./assets/docs/required_kt.png' },
    lg: { title:'LG 구비서류', src:'./assets/docs/required_lg.png' },
  };

  function openModal(key){
    const d = DOCS[key];
    if (!d) return;
    titleEl.textContent = d.title;
    imgEl.src = d.src;
    imgEl.alt = d.title;
    modal.classList.add('open');
    modal.setAttribute('aria-hidden','false');
  }

  function closeModal(){
    modal.classList.remove('open');
    modal.setAttribute('aria-hidden','true');
    imgEl.classList.remove('zoom');
    imgEl.src = '';
  }

  document.querySelectorAll('[data-docs]').forEach(btn=>{
    btn.addEventListener('click', ()=> openModal(btn.dataset.docs));
  });

  closeBtn?.addEventListener('click', closeModal);

  modal?.addEventListener('click', (e)=>{
    const t = e.target;
    if (t && t.dataset && t.dataset.close === '1') closeModal();
  });

  window.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape' && modal.classList.contains('open')) closeModal();
  });
})();

/* 단말개통 - 업데이트 예정 모달 (device-comingsoon만 대상) */
(function(){
  const modal = document.getElementById('comingSoonModal');
  const body  = document.getElementById('csBody');
  const xBtn  = document.getElementById('csCloseX');
  const okBtn = document.getElementById('csOkBtn');

  function openCS(text){
    body.textContent = text;
    modal.setAttribute('aria-hidden','false');
  }
  function closeCS(){
    modal.setAttribute('aria-hidden','true');
  }

  document.addEventListener('click', (e)=>{
    const card = e.target.closest('.device-comingsoon');
    if (card){
      const brand = card.getAttribute('data-device') || '';
      openCS(`${brand} 단말 개통 기능은 현재 업데이트 예정입니다.`);
      return;
    }
    const t = e.target;
    if (t && t.dataset && t.dataset.csClose === '1') closeCS();
  });

  xBtn?.addEventListener('click', closeCS);
  okBtn?.addEventListener('click', closeCS);

  window.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeCS();
  });
})();

/* 유심/동판 양식 팝업 + 복사 */
(function(){
  const modal = document.getElementById('formModal');
  const title = document.getElementById('formTitle');
  const ta    = document.getElementById('formTextarea');
  const toast = document.getElementById('formToast');
  const xBtn  = document.getElementById('formCloseX');
  const copyBtn = document.getElementById('formCopyBtn');
  const selBtn  = document.getElementById('formSelectAll');

  const FORMS = {
    usim: {
      title: '유심 개통 양식',
      text:
`■ 개통채널 : 중고KT
□ 유형 : 신규 / 번호이동
□ 고객명 :
□ 생년월일 :
□ 연락처 :
□ 신규/번호이동 :
□ 기존통신사 :
□ 희망번호 뒷4자리 :
□ 요금제 :
□ 유심모델명/일련번호 :
□ 복지할인 :
□ 단말정보
- 모델명 :
- IMEI :
□ 선택약정 :
□ URL작성 유/무 :`
    },
    dongpan: {
      title: '동판 인터넷 접수 양식',
      text:
`♣동판 인터넷 접수♣

- 모바일 개통여부 :
- 결합 통신사(엠모바일/KT) :
- 결합요청 번호 :


고객정보
- 고객명 :
- 설치주소(층/동/호 필수) :
- 부재 시 비상연락처  :
- 납부계좌(타인불가) :
- 판매점 연락처 :
- ★고객 이메일 : 

홈 상품정보
- 통신사  : KT
- 상품명 :
- WIFI 설치 여부(O/X) :
- 월요금 :

↓↓원스톱 진행 시 작성↓↓

[원스톱양식]
기존 통신사 : 
해지할 명의자 이름 : 
해지할 명의자 생년월일 : 
해지할 명의자 연락처 : 
해지할 주소 : 
해지 회선수 :
설치 희망일 : 
해지 희망일 : 

============================

✅구비서류
내국인- 신분증
외국인- 외국인 등록증 앞/뒷면

✅사전안내
접수 전 고객 본인확인차 인증번호 확인 필요하며, 원스톱 진행 시에는 접수 후 원스톱 URL 인증절차까지 진행되어야 최종 접수완료됩니다.`
    }
  };

  function showToast(){
    toast.classList.add('show');
    setTimeout(()=>toast.classList.remove('show'), 1200);
  }

  function openForm(key){
    const f = FORMS[key];
    if (!f) return;
    title.textContent = f.title;
    ta.value = f.text;
    modal.setAttribute('aria-hidden','false');
    ta.scrollTop = 0;
    ta.focus();
  }

  function closeForm(){
    modal.setAttribute('aria-hidden','true');
    ta.value = '';
    toast.classList.remove('show');
  }

  async function copyText(text){
    try{
      await navigator.clipboard.writeText(text);
      showToast();
      return;
    }catch(_){}
    try{
      ta.focus();
      ta.select();
      document.execCommand('copy');
      showToast();
    }catch(_){}
  }

  document.addEventListener('click', (e)=>{
    const btn = e.target.closest('[data-form]');
    if (btn){
      e.preventDefault();
      e.stopPropagation();
      openForm(btn.getAttribute('data-form'));
      return;
    }
    const t = e.target;
    if (t && t.dataset && t.dataset.formClose === '1') closeForm();
  });

  document.addEventListener('keydown', (e)=>{
    if (e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeForm();
    const active = document.activeElement;
    if ((e.key === 'Enter' || e.key === ' ') && active && active.matches && active.matches('[data-form]')){
      e.preventDefault();
      openForm(active.getAttribute('data-form'));
    }
  });

  xBtn?.addEventListener('click', closeForm);
  selBtn?.addEventListener('click', ()=>{
    ta.focus();
    ta.select();
  });
  copyBtn?.addEventListener('click', ()=> copyText(ta.value));
})();

window.addEventListener('DOMContentLoaded', ()=>{
  wireKindTabs('joinTabs','joinTabsList',JOIN_DATA);

  // ✅ 선불 섹션 렌더
  renderPrepaid(document.getElementById('prepaidList'));

  wireTabs('changeTabs','changeTabsList',CHANGE_CARDS);
  wireTabs('cancelTabs','cancelTabsList',CANCEL_CARDS);
  updateDeviceLogosByAge();
});

</script>
</body>
</html>
